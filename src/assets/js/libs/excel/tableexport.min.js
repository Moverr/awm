
/*!
 * TableExport.js v3.2.5 (http://www.clarketravis.com)
 * Copyright 2016 Travis Clarke
 * Licensed under the MIT license
 */
(function(g,b){var d=g.jQuery;d.fn.tableExport=function(t,s){var o=this,l=s?t:d.extend({},d.fn.tableExport.defaults,t),j=d.fn.tableExport.rowDel,p=l.ignoreRows instanceof Array?l.ignoreRows:[l.ignoreRows],m=l.ignoreCols instanceof Array?l.ignoreCols:[l.ignoreCols],n=l.ignoreCSS instanceof Array?l.ignoreCSS.join(", "):l.ignoreCSS,q,r,k;if(l.bootstrap){q=d.fn.tableExport.bootstrap[0]+" ";r=d.fn.tableExport.bootstrap[1]+" ";k=d.fn.tableExport.bootstrap[2]+" "}else{q=d.fn.tableExport.defaultButton+" ";r=k=""}o.each(function(){var w=d(this);if(s){w.find("caption:not(.head)").remove()}var v=w.find("tbody").find("tr"),v=l.headings?v.add(w.find("thead>tr")):v,v=l.footers?v.add(w.find("tfoot>tr")):v,z=l.headings?w.find("thead>tr").length:0,A=l.fileName==="id"?(w.attr("id")?w.attr("id"):d.fn.tableExport.defaultFileName):l.fileName,x={xlsx:function(F,B){var G=v.map(function(I,J){if(!!~p.indexOf(I-z)||d(J).is(n)){return}var H=d(J).find("th, td");return[H.map(function(K,L){if(!!~m.indexOf(K)||d(L).is(n)){return}return d(L).text()}).get()]}).get(),E=c(JSON.stringify({data:G,fileName:B,mimeType:d.fn.tableExport.xlsx.mimeType,fileExtension:d.fn.tableExport.xlsx.fileExtension})),D=d.fn.tableExport.xlsx.buttonContent,C=d.fn.tableExport.xlsx.defaultClass;y(E,D,C)},xls:function(C,D){var B=d.fn.tableExport.xls.separator,H=v.map(function(J,K){if(!!~p.indexOf(J-z)||d(K).is(n)){return}var I=d(K).find("th, td");return I.map(function(L,M){if(!!~m.indexOf(L)||d(M).is(n)){return}return d(M).text()}).get().join(B)}).get().join(C),G=c(JSON.stringify({data:H,fileName:D,mimeType:d.fn.tableExport.xls.mimeType,fileExtension:d.fn.tableExport.xls.fileExtension})),F=d.fn.tableExport.xls.buttonContent,E=d.fn.tableExport.xls.defaultClass;y(G,F,E)},csv:function(C,D){var B=d.fn.tableExport.csv.separator,H=v.map(function(J,K){if(!!~p.indexOf(J-z)||d(K).is(n)){return}var I=d(K).find("th, td");return I.map(function(L,M){if(!!~m.indexOf(L)||d(M).is(n)){return}return d(M).text()}).get().join(B)}).get().join(C),G=c(JSON.stringify({data:H,fileName:D,mimeType:d.fn.tableExport.csv.mimeType,fileExtension:d.fn.tableExport.csv.fileExtension})),F=d.fn.tableExport.csv.buttonContent,E=d.fn.tableExport.csv.defaultClass;y(G,F,E)},txt:function(C,D){var B=d.fn.tableExport.txt.separator,H=v.map(function(J,K){if(!!~p.indexOf(J-z)||d(K).is(n)){return}var I=d(K).find("th, td");return I.map(function(L,M){if(!!~m.indexOf(L)||d(M).is(n)){return}return d(M).text()}).get().join(B)}).get().join(C),G=c(JSON.stringify({data:H,fileName:D,mimeType:d.fn.tableExport.txt.mimeType,fileExtension:d.fn.tableExport.txt.fileExtension})),F=d.fn.tableExport.txt.buttonContent,E=d.fn.tableExport.txt.defaultClass;y(G,F,E)}};l.formats.forEach(function(B){x[B](j,A)});function u(B){var C=w.find("caption:not(.head)");C.length?C.append(B):w.prepend('<caption class="'+k+l.position+'">'+B+"</caption>")}function y(D,C,B){var E="<button data-fileblob='"+D+"' class='"+q+r+B+"'>"+C+"</button>";u(E)}});d("button[data-fileblob]").off("click").on("click",function(){var u=d(this).data("fileblob"),v=u.data,y=u.fileName,x=u.mimeType,w=u.fileExtension;i(v,x,y,w)});d.fn.tableExport.update=function(u){o.tableExport(d.extend({},l,u),true)};d.fn.tableExport.reset=function(u){o.tableExport(l,true)};d.fn.tableExport.remove=function(u){o.each(function(){d(this).find("caption:not(.head)").remove()})};return o};d.fn.tableExport.defaults={headings:true,footers:true,formats:["xls","xlsx"],fileName:"id",bootstrap:true,position:"bottom",ignoreRows:null,ignoreCols:null,ignoreCSS:".tableexport-ignore"};d.fn.tableExport.charset="charset=utf-8";d.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileExtension:".xlsx"};d.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"\t",mimeType:"application/vnd.ms-excel",fileExtension:".xls"};d.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:",",mimeType:"application/csv",fileExtension:".csv"};d.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  ",mimeType:"text/plain",fileExtension:".txt"};d.fn.tableExport.defaultFileName="Awamo Report";d.fn.tableExport.defaultButton="button-default";d.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"];d.fn.tableExport.rowDel="\r\n";d.fn.tableExport.entityMap={"&":"&#38;","<":"&#60;",">":"&#62;","'":"&#39;","/":"&#47"};function c(j){return String(j).replace(/[&<>'\/]/g,function(k){return d.fn.tableExport.entityMap[k]})}function a(k,j){if(j){k+=1462}var l=Date.parse(k);return(l-new Date(Date.UTC(1899,11,30)))/(24*60*60*1000)}function e(p,o){var k={};var l={s:{c:10000000,r:10000000},e:{c:0,r:0}};for(var n=0;n!=p.length;++n){for(var q=0;q!=p[n].length;++q){if(l.s.r>n){l.s.r=n}if(l.s.c>q){l.s.c=q}if(l.e.r<n){l.e.r=n}if(l.e.c<q){l.e.c=q}var j={v:p[n][q]};if(j.v==null){continue}var m=XLSX.utils.encode_cell({c:q,r:n});if(typeof j.v==="number"){j.t="n"}else{if(typeof j.v==="boolean"){j.t="b"}else{if(j.v instanceof Date){j.t="n";j.z=XLSX.SSF._table[14];j.v=a(j.v)}else{j.t="s"}}}k[m]=j}}if(l.s.c<10000000){k["!ref"]=XLSX.utils.encode_range(l)}return k}function h(){if(!(this instanceof h)){return new h()}this.SheetNames=[];this.Sheets={}}function f(m){var k=new ArrayBuffer(m.length);var j=new Uint8Array(k);for(var l=0;l!=m.length;++l){j[l]=m.charCodeAt(l)&255}return k}function i(p,o,k,q){if(q===".xlsx"){var n=new h(),j=e(p);n.SheetNames.push(k);n.Sheets[k]=j;var m={bookType:"xlsx",bookSST:false,type:"binary"},l=XLSX.write(n,m);p=f(l)}saveAs(new Blob([p],{type:o+";"+d.fn.tableExport.charset}),k+q)}}(window));